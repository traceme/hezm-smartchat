# 智能电子书对话系统 PRD

## 项目概述

开发一个基于Web的电子书智能对话系统，支持多格式文档上传、智能转换、向量化索引和自然语言交互。

## 核心功能

### 1. 多格式电子书上传与管理系统
**目标**: 提供用户友好的文档上传和管理界面
- 支持PDF、EPUB、TXT、DOCX等主流格式
- 实现分片上传(5MB/chunk)和并发处理
- SHA-256去重检查避免重复存储
- 拖拽上传功能和批量处理
- WebSocket实时进度推送
- S3预签名URL安全上传

### 2. 文档格式转换引擎
**目标**: 将各种格式文档转换为结构化Markdown
- 集成Microsoft MarkItDown进行格式转换
- Celery异步任务队列处理大文件
- 保留文档结构(标题、段落、表格、图片占位)
- 转换状态实时反馈
- 错误处理和重试机制

### 3. 知识向量化与索引系统
**目标**: 建立高效的知识检索体系
- 文本智能切分(1-2k tokens语义块)
- Qwen3-Embedding-8B向量化
- Qdrant向量数据库存储
- 倒排索引构建
- 混合检索策略优化

### 4. 智能对话引擎
**目标**: 提供准确的问答和内容理解
- 向量检索top-30相关片段
- bge-reranker-base重排序优化
- 多模型支持(OpenAI GPT-4o、Claude、Gemini)
- 答案引用和定位
- 流式响应生成

### 5. Gmail风格用户界面
**目标**: 提供熟悉易用的交互体验
- Material-UI v6组件设计
- 左侧文档列表管理
- 右侧对话区域
- 响应式设计(移动端≥360px)
- Markdown渲染支持
- 实时状态反馈

## 技术架构

### 前端技术栈
- React + TypeScript
- Material-UI v6
- WebSocket客户端
- 文件分片上传
- Markdown渲染器

### 后端技术栈
- Python + FastAPI
- Celery任务队列
- SQLAlchemy ORM
- Redis缓存
- WebSocket支持

### 数据存储
- PostgreSQL(元数据)
- Qdrant(向量数据库)
- 文件存储在本地文件夹
- Redis(缓存和会话)

### AI服务集成
- Qwen3-Embedding-8B
- OpenAI GPT-4o
- Claude API
- bge-reranker-base

## 关键用户流程

1. **文档上传**: 用户拖拽/选择文件批量上传，实时查看转换进度
2. **文档管理**: 浏览、搜索、分类和删除已上传文档
3. **开始对话**: 选择文档，在对话界面输入问题
4. **智能问答**: 系统检索相关内容，生成带引用的答案
5. **结果查看**: 用户查看答案并可跳转到原文位置

## 性能指标

- 首屏加载时间: ≤1秒
- 对话响应时间: P95≤4秒
- 文档上传速度: 支持100MB+文件
- 并发用户支持: 100+用户同时使用
- 检索准确率: Top-5命中率≥85%

## 项目里程碑

### Phase 1: 基础架构搭建
- 项目初始化和环境配置
- 数据库设计和模型定义
- 基础API框架搭建

### Phase 2: 文档处理系统
- 文件上传功能实现
- MarkItDown格式转换集成
- 向量化和索引系统

### Phase 3: 对话系统开发
- 检索引擎实现
- 多模型LLM集成
- 问答逻辑优化

### Phase 4: 用户界面开发
- Gmail风格UI设计
- 响应式布局实现
- 交互优化和测试

### Phase 5: 系统集成和优化
- 端到端功能测试
- 性能优化
- 部署和监控配置 